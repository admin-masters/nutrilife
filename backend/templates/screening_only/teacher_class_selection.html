<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Select Class and Section</title>
  <style>
    body{
  font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  max-width: 1000px;
  margin: 0 auto;
  padding: 24px;
  background: #fafafa;
  color:#111;
}

/* Container becomes card style */
.container{
  max-width: 520px;
  margin: 40px auto;
  background:#fff;
  border:1px solid #e5e7eb;
  border-radius:12px;
  padding:24px;
}

/* Heading */
h1{
  font-size: 26px;
  font-weight: 700;
  margin-bottom: 20px;
}

/* Rows */
.row{
  margin:18px 0;
}

/* Labels */
label{
  display:block;
  font-weight:600;
  margin-bottom:6px;
  font-size:14px;
  color:#374151;
}

/* Select inputs */
select{
  width:100%;
  padding:10px;
  border:1px solid #e5e7eb;
  border-radius:8px;
  font-size:14px;
  background:#fff;
}

/* Button – same as add-btn */
.btn{
  margin-top:20px;
  display:inline-block;
  padding:12px 20px;
  background:#000;
  color:#fff;
  border:1px solid #000;
  border-radius:10px;
  font-size:14px;
  font-weight:500;
  cursor:pointer;
}

.btn:hover{
  opacity:.9;
}
  </style>
</head>
<body>
  <div class="container">
    <h1>Select Class and Section</h1>

    <form method="post">
      {% csrf_token %}

      <div class="row">
        <label for="id_grade">Class</label>
        <select id="id_grade" name="grade" required>
          <option value="">Select class</option>
          {% for g in grades %}
            <option value="{{ g }}" {% if selected_grade == g %}selected{% endif %}>{{ g }}</option>
          {% endfor %}
        </select>
      </div>

      <div class="row">
        <label for="id_division">Section</label>
        <select id="id_division" name="division" required>
          <option value="">Select section</option>
        </select>
      </div>

      <button class="btn" type="submit">Continue</button>
    </form>
  </div>

  <script>
    const divisionsByGrade = {{ divisions_by_grade|safe }};
    const gradeSelect = document.getElementById("id_grade");
    const divisionSelect = document.getElementById("id_division");

    let initialDivision = "{{ selected_division|escapejs }}";

    function syncDivisionOptions() {
      const grade = gradeSelect.value;

      divisionSelect.innerHTML = "";
      const placeholder = document.createElement("option");
      placeholder.value = "";
      placeholder.textContent = "Select section";
      divisionSelect.appendChild(placeholder);

      if (!grade || !divisionsByGrade[grade]) return;

      divisionsByGrade[grade].forEach(function(div) {
        const opt = document.createElement("option");
        opt.value = div;
        opt.textContent = div || "—";
        if (initialDivision && div === initialDivision) opt.selected = true;
        divisionSelect.appendChild(opt);
      });
    }

    gradeSelect.addEventListener("change", function() {
      initialDivision = "";   // user is changing grade; don't auto-select old division
      syncDivisionOptions();
    });

    // init
    syncDivisionOptions();
  </script>
</body>
</html>